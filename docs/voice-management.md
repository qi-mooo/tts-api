# è¯­éŸ³ç®¡ç†æŒ‡å—

TTS API é›†æˆäº†å®Œæ•´çš„ Microsoft Edge-TTS è¯­éŸ³ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒ 322+ ä¸ªè¯­éŸ³ï¼ŒåŒ…æ‹¬ 14 ä¸ªä¸­æ–‡è¯­éŸ³ã€‚æœ¬æŒ‡å—å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨è¯­éŸ³ç®¡ç†åŠŸèƒ½ã€‚

## æ¦‚è¿°

è¯­éŸ³ç®¡ç†ç³»ç»Ÿæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

- ğŸ¤ **è¯­éŸ³åˆ—è¡¨ç®¡ç†**: è‡ªåŠ¨è·å–å’Œæ›´æ–° Edge-TTS è¯­éŸ³åˆ—è¡¨
- ğŸ” **è¯­éŸ³æœç´¢**: æ ¹æ®åç§°ã€æ€§åˆ«ã€åœ°åŒºæœç´¢è¯­éŸ³
- âœ… **è¯­éŸ³éªŒè¯**: éªŒè¯è¯­éŸ³åç§°æ˜¯å¦æœ‰æ•ˆ
- ğŸ“Š **ç»Ÿè®¡ä¿¡æ¯**: æä¾›è¯¦ç»†çš„è¯­éŸ³ç»Ÿè®¡æ•°æ®
- ğŸŒ **åœ°åŒºç®¡ç†**: æŒ‰åœ°åŒºç»„ç»‡å’Œç­›é€‰è¯­éŸ³
- âš™ï¸ **é…ç½®é›†æˆ**: ä¸ç³»ç»Ÿé…ç½®æ— ç¼é›†æˆ

## æ”¯æŒçš„è¯­éŸ³

### ä¸­æ–‡è¯­éŸ³ï¼ˆ14ä¸ªï¼‰

#### ä¸­å›½å¤§é™† (zh-CN) - 6ä¸ªè¯­éŸ³

| è¯­éŸ³åç§° | æ€§åˆ« | æè¿° | æ¨èç”¨é€” |
|---------|------|------|----------|
| **zh-CN-YunjianNeural** | ç”·æ€§ | æ ‡å‡†æ™®é€šè¯ï¼Œå£°éŸ³æ²‰ç¨³ | é»˜è®¤æ—ç™½è¯­éŸ³ â­ |
| **zh-CN-XiaoyiNeural** | å¥³æ€§ | æ ‡å‡†æ™®é€šè¯ï¼Œå£°éŸ³æ¸…æ™° | é»˜è®¤å¯¹è¯è¯­éŸ³ â­ |
| zh-CN-XiaoxiaoNeural | å¥³æ€§ | æ ‡å‡†æ™®é€šè¯ï¼Œå£°éŸ³ç”œç¾ | å¥³æ€§è§’è‰²å¯¹è¯ |
| zh-CN-YunxiNeural | ç”·æ€§ | æ ‡å‡†æ™®é€šè¯ï¼Œå£°éŸ³å¹´è½» | å¹´è½»ç”·æ€§è§’è‰² |
| zh-CN-YunxiaNeural | ç”·æ€§ | æ ‡å‡†æ™®é€šè¯ï¼Œå£°éŸ³æ¸©å’Œ | æ¸©å’Œç”·æ€§è§’è‰² |
| zh-CN-YunyangNeural | ç”·æ€§ | æ ‡å‡†æ™®é€šè¯ï¼Œå£°éŸ³æˆç†Ÿ | æˆç†Ÿç”·æ€§è§’è‰² |

#### é¦™æ¸¯ (zh-HK) - 3ä¸ªè¯­éŸ³

| è¯­éŸ³åç§° | æ€§åˆ« | æè¿° | æ¨èç”¨é€” |
|---------|------|------|----------|
| zh-HK-HiuGaaiNeural | å¥³æ€§ | ç²¤è¯­ä¼ ç»Ÿå‘éŸ³ | ç²¤è¯­å†…å®¹ |
| zh-HK-HiuMaanNeural | å¥³æ€§ | é¦™æ¸¯æ™®é€šè¯ | æ¸¯å¼æ™®é€šè¯ |
| zh-HK-WanLungNeural | ç”·æ€§ | é¦™æ¸¯æ™®é€šè¯ | æ¸¯å¼ç”·æ€§è§’è‰² |

#### å°æ¹¾ (zh-TW) - 3ä¸ªè¯­éŸ³

| è¯­éŸ³åç§° | æ€§åˆ« | æè¿° | æ¨èç”¨é€” |
|---------|------|------|----------|
| zh-TW-HsiaoChenNeural | å¥³æ€§ | å°æ¹¾å›½è¯­ | å°æ¹¾å¥³æ€§è§’è‰² |
| zh-TW-YunJheNeural | ç”·æ€§ | å°æ¹¾å›½è¯­ | å°æ¹¾ç”·æ€§è§’è‰² |
| zh-TW-HsiaoYuNeural | å¥³æ€§ | å°æ¹¾å®˜è¯ | æ­£å¼å°æ¹¾å†…å®¹ |

#### æ–¹è¨€è¯­éŸ³ - 2ä¸ªè¯­éŸ³

| è¯­éŸ³åç§° | æ€§åˆ« | æè¿° | æ¨èç”¨é€” |
|---------|------|------|----------|
| zh-CN-liaoning-XiaobeiNeural | å¥³æ€§ | ä¸œåŒ—å®˜è¯ | ä¸œåŒ—æ–¹è¨€å†…å®¹ |
| zh-CN-shaanxi-XiaoniNeural | å¥³æ€§ | é™•è¥¿å®˜è¯ | è¥¿åŒ—æ–¹è¨€å†…å®¹ |

### å…¨çƒè¯­éŸ³æ”¯æŒ

é™¤äº†ä¸­æ–‡è¯­éŸ³ï¼Œç³»ç»Ÿè¿˜æ”¯æŒï¼š

- **æ€»è¯­éŸ³æ•°**: 322+ ä¸ª
- **æ”¯æŒåœ°åŒº**: 142 ä¸ª
- **è¯­è¨€è¦†ç›–**: åŒ…æ‹¬è‹±è¯­ã€æ—¥è¯­ã€éŸ©è¯­ã€æ³•è¯­ã€å¾·è¯­ã€è¥¿ç­ç‰™è¯­ç­‰ä¸»è¦è¯­è¨€

## è¯­éŸ³ç®¡ç† API

### 1. è·å–è¯­éŸ³åˆ—è¡¨

```bash
# è·å–æ‰€æœ‰ä¸­æ–‡è¯­éŸ³
curl "http://localhost:8080/api/voices"

# è·å–æ‰€æœ‰è¯­éŸ³
curl "http://localhost:8080/api/voices?chinese_only=false"

# æŒ‰æ€§åˆ«ç­›é€‰
curl "http://localhost:8080/api/voices?gender=Female"

# æŒ‰åœ°åŒºç­›é€‰
curl "http://localhost:8080/api/voices?locale=zh-CN"

# ç»„åˆç­›é€‰
curl "http://localhost:8080/api/voices?locale=zh-CN&gender=Male"
```

### 2. è¯­éŸ³æœç´¢

```bash
# æœç´¢ç‰¹å®šè¯­éŸ³
curl "http://localhost:8080/api/voices/search?q=Yunjian"

# æœç´¢å¥³æ€§è¯­éŸ³
curl "http://localhost:8080/api/voices/search?q=Female"

# æœç´¢å°æ¹¾è¯­éŸ³
curl "http://localhost:8080/api/voices/search?q=Taiwan"

# æœç´¢ç²¤è¯­è¯­éŸ³
curl "http://localhost:8080/api/voices/search?q=Cantonese"
```

### 3. è¯­éŸ³éªŒè¯

```bash
# éªŒè¯è¯­éŸ³æ˜¯å¦æœ‰æ•ˆ
curl -X POST "http://localhost:8080/api/voices/validate" \
  -H "Content-Type: application/json" \
  -d '{"voice_name": "zh-CN-YunjianNeural"}'
```

### 4. è·å–ç»Ÿè®¡ä¿¡æ¯

```bash
# è·å–è¯­éŸ³ç»Ÿè®¡
curl "http://localhost:8080/api/voices/stats"

# è·å–åœ°åŒºåˆ—è¡¨
curl "http://localhost:8080/api/voices/locales"
```

## åœ¨ TTS API ä¸­ä½¿ç”¨è¯­éŸ³

### åŸºç¡€ç”¨æ³•

```bash
# ä½¿ç”¨é»˜è®¤è¯­éŸ³
curl "http://localhost:8080/api?text=ä½ å¥½ä¸–ç•Œ"

# æŒ‡å®šæ—ç™½è¯­éŸ³
curl "http://localhost:8080/api?text=ä½ å¥½ä¸–ç•Œ&narr=zh-CN-YunjianNeural"

# æŒ‡å®šå¯¹è¯è¯­éŸ³
curl "http://localhost:8080/api?text=ä½ å¥½ä¸–ç•Œ&dlg=zh-CN-XiaoyiNeural"

# ç»Ÿä¸€ä½¿ç”¨ä¸€ä¸ªè¯­éŸ³
curl "http://localhost:8080/api?text=ä½ å¥½ä¸–ç•Œ&all=zh-CN-XiaoxiaoNeural"
```

### é«˜çº§ç”¨æ³•

```bash
# æ··åˆä½¿ç”¨ä¸åŒåœ°åŒºçš„è¯­éŸ³
curl "http://localhost:8080/api?text=å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°æ˜ã€‚&narr=zh-CN-YunjianNeural&dlg=zh-TW-YunJheNeural"

# ä½¿ç”¨æ–¹è¨€è¯­éŸ³
curl "http://localhost:8080/api?text=ä½ å¥½ï¼Œæˆ‘æ¥è‡ªä¸œåŒ—ã€‚&all=zh-CN-liaoning-XiaobeiNeural"

# ç²¤è¯­å†…å®¹
curl "http://localhost:8080/api?text=ä½ å¥½ï¼Œæ¬¢è¿æ¥åˆ°é¦™æ¸¯ã€‚&all=zh-HK-HiuGaaiNeural"
```

## è¯­éŸ³ç®¡ç†ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

1. **VoiceManager**: æ ¸å¿ƒè¯­éŸ³ç®¡ç†å™¨
   - è¯­éŸ³æ•°æ®åŠ è½½å’Œç¼“å­˜
   - è¯­éŸ³éªŒè¯å’Œæœç´¢
   - ç»Ÿè®¡ä¿¡æ¯ç”Ÿæˆ

2. **æ•°æ®æ–‡ä»¶**:
   - `data/voices.json`: å®Œæ•´è¯­éŸ³æ•°æ®
   - `data/voices_simplified.json`: ç®€åŒ–çš„ä¸­æ–‡è¯­éŸ³åˆ—è¡¨
   - `data/chinese_voices_map.json`: ä¸­æ–‡è¯­éŸ³å¿«é€Ÿæ˜ å°„

3. **API ç«¯ç‚¹**: é›†æˆåœ¨ä¸»åº”ç”¨ä¸­çš„ RESTful API

### æ•°æ®æµç¨‹

```
Edge-TTS API â†’ è¯­éŸ³æ•°æ®è·å– â†’ æœ¬åœ°å­˜å‚¨ â†’ VoiceManager â†’ API ç«¯ç‚¹ â†’ å®¢æˆ·ç«¯
```

## è¯­éŸ³ç®¡ç†è„šæœ¬

### å®‰è£…è¯­éŸ³åˆ—è¡¨

```bash
# è·å–æœ€æ–°è¯­éŸ³åˆ—è¡¨
./venv/bin/python3 scripts/install_voices.py

# æ›´æ–°è¯­éŸ³åˆ—è¡¨ï¼ˆè¯¦ç»†ç‰ˆï¼‰
./venv/bin/python3 scripts/update_voices.py
```

### é›†æˆåˆ°ç³»ç»Ÿ

```bash
# é›†æˆè¯­éŸ³ç®¡ç†å™¨åˆ°é…ç½®
./venv/bin/python3 scripts/integrate_voice_manager.py
```

### æµ‹è¯•è¯­éŸ³ç³»ç»Ÿ

```bash
# æµ‹è¯•è¯­éŸ³ç®¡ç†å™¨
./venv/bin/python3 test_voice_manager.py

# æµ‹è¯•è¯­éŸ³ API
./venv/bin/python3 test_voice_api.py
```

## é…ç½®ç®¡ç†

### é»˜è®¤è¯­éŸ³é…ç½®

è¯­éŸ³ç®¡ç†å™¨ä¼šè‡ªåŠ¨æ›´æ–° `config.json` æ–‡ä»¶ï¼š

```json
{
  "tts": {
    "default_narrator_voice": "zh-CN-YunjianNeural",
    "default_dialogue_voice": "zh-CN-XiaoyiNeural",
    "available_voices": [
      {
        "name": "zh-CN-YunjianNeural",
        "display_name": "Microsoft Yunjian Online (Natural) - Chinese (Mainland)",
        "gender": "Male",
        "locale": "zh-CN"
      }
    ],
    "voice_stats": {
      "total_voices": 322,
      "chinese_voices": 14
    }
  }
}
```

### åœ¨ä»£ç ä¸­ä½¿ç”¨

```python
from voice_manager import VoiceManager, get_default_narrator_voice

# è·å–è¯­éŸ³ç®¡ç†å™¨å®ä¾‹
vm = VoiceManager()

# è·å–é»˜è®¤è¯­éŸ³
narrator = get_default_narrator_voice()  # zh-CN-YunjianNeural
dialogue = get_default_dialogue_voice()  # zh-CN-XiaoyiNeural

# éªŒè¯è¯­éŸ³
is_valid = vm.validate_voice("zh-CN-YunjianNeural")

# è·å–ä¸­æ–‡è¯­éŸ³åˆ—è¡¨
chinese_voices = vm.get_chinese_voices()

# æœç´¢è¯­éŸ³
female_voices = vm.search_voices("Female", chinese_only=True)
```

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

1. **å†…å­˜ç¼“å­˜**: è¯­éŸ³æ•°æ®åœ¨é¦–æ¬¡åŠ è½½åç¼“å­˜åœ¨å†…å­˜ä¸­
2. **æ‡’åŠ è½½**: åªåœ¨éœ€è¦æ—¶åŠ è½½è¯­éŸ³æ•°æ®
3. **æ•°æ®å‹ç¼©**: ä½¿ç”¨ç®€åŒ–çš„æ•°æ®ç»“æ„å‡å°‘å†…å­˜å ç”¨

### å“åº”æ—¶é—´ä¼˜åŒ–

- **è¯­éŸ³åˆ—è¡¨**: < 5ms
- **è¯­éŸ³éªŒè¯**: < 2ms
- **è¯­éŸ³æœç´¢**: < 10ms
- **ç»Ÿè®¡ä¿¡æ¯**: < 3ms

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. è¯­éŸ³åˆ—è¡¨ä¸ºç©º

**ç—‡çŠ¶**: API è¿”å›ç©ºçš„è¯­éŸ³åˆ—è¡¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡æ–°è·å–è¯­éŸ³åˆ—è¡¨
./venv/bin/python3 scripts/install_voices.py

# æ£€æŸ¥æ•°æ®æ–‡ä»¶
ls -la data/voices*.json
```

#### 2. è¯­éŸ³éªŒè¯å¤±è´¥

**ç—‡çŠ¶**: æœ‰æ•ˆçš„è¯­éŸ³åç§°éªŒè¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥è¯­éŸ³æ•°æ®å®Œæ•´æ€§
./venv/bin/python3 -c "
from voice_manager import VoiceManager
vm = VoiceManager()
print(f'è¯­éŸ³æ•°é‡: {len(vm.get_all_voices())}')
"

# é‡æ–°é›†æˆé…ç½®
./venv/bin/python3 scripts/integrate_voice_manager.py
```

#### 3. ç½‘ç»œè¿æ¥é—®é¢˜

**ç—‡çŠ¶**: æ— æ³•ä» Microsoft è·å–è¯­éŸ³åˆ—è¡¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
curl -I https://speech.platform.bing.com

# ä½¿ç”¨ä»£ç†ï¼ˆå¦‚æœéœ€è¦ï¼‰
export https_proxy=http://proxy.example.com:8080
./venv/bin/python3 scripts/install_voices.py
```

#### 4. API ç«¯ç‚¹è¿”å› 404

**ç—‡çŠ¶**: è¯­éŸ³ç®¡ç† API ç«¯ç‚¹ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿ä½¿ç”¨ `app_enhanced.py` ä½œä¸ºä¸»åº”ç”¨æ–‡ä»¶
- æ£€æŸ¥è¯­éŸ³ç®¡ç†å™¨æ˜¯å¦æ­£ç¡®å¯¼å…¥
- éªŒè¯è·¯ç”±æ˜¯å¦æ­£ç¡®æ³¨å†Œ

### è°ƒè¯•æŠ€å·§

#### 1. æ£€æŸ¥è¯­éŸ³æ•°æ®

```bash
# æŸ¥çœ‹è¯­éŸ³æ–‡ä»¶
ls -la data/
cat data/voices_summary.json

# æµ‹è¯•è¯­éŸ³ç®¡ç†å™¨
./venv/bin/python3 -c "
from voice_manager import voice_manager
stats = voice_manager.get_voice_stats()
print(f'ç»Ÿè®¡ä¿¡æ¯: {stats}')
"
```

#### 2. éªŒè¯ API é›†æˆ

```bash
# æ£€æŸ¥æ ¹ç«¯ç‚¹æ˜¯å¦åŒ…å«è¯­éŸ³ä¿¡æ¯
curl "http://localhost:8080/" | grep -i voice

# æµ‹è¯•è¯­éŸ³ç«¯ç‚¹
curl "http://localhost:8080/api/voices/stats"
```

#### 3. æ—¥å¿—åˆ†æ

```bash
# æŸ¥çœ‹è¯­éŸ³ç›¸å…³æ—¥å¿—
tail -f logs/app.log | grep -i voice

# æœç´¢é”™è¯¯ä¿¡æ¯
grep -i "voice\|error" logs/app.log
```

## æœ€ä½³å®è·µ

### 1. è¯­éŸ³é€‰æ‹©å»ºè®®

- **æ—ç™½å†…å®¹**: ä½¿ç”¨ `zh-CN-YunjianNeural`ï¼ˆç”·æ€§ï¼Œæ²‰ç¨³ï¼‰
- **å¯¹è¯å†…å®¹**: ä½¿ç”¨ `zh-CN-XiaoyiNeural`ï¼ˆå¥³æ€§ï¼Œæ¸…æ™°ï¼‰
- **æ­£å¼å†…å®¹**: ä½¿ç”¨æ ‡å‡†æ™®é€šè¯è¯­éŸ³
- **åœ°æ–¹å†…å®¹**: ä½¿ç”¨å¯¹åº”åœ°åŒºçš„è¯­éŸ³

### 2. æ€§èƒ½ä¼˜åŒ–

```python
# æ‰¹é‡éªŒè¯è¯­éŸ³
voices_to_check = ["zh-CN-YunjianNeural", "zh-CN-XiaoyiNeural"]
vm = VoiceManager()
results = {voice: vm.validate_voice(voice) for voice in voices_to_check}
```

### 3. é”™è¯¯å¤„ç†

```python
from voice_manager import VoiceManager

def safe_get_voice_info(voice_name):
    try:
        vm = VoiceManager()
        if vm.validate_voice(voice_name):
            return vm.get_voice_by_name(voice_name)
        else:
            # ä½¿ç”¨é»˜è®¤è¯­éŸ³
            return vm.get_voice_by_name("zh-CN-YunjianNeural")
    except Exception as e:
        print(f"è·å–è¯­éŸ³ä¿¡æ¯å¤±è´¥: {e}")
        return None
```

### 4. å®šæœŸæ›´æ–°

```bash
# è®¾ç½®å®šæ—¶ä»»åŠ¡æ›´æ–°è¯­éŸ³åˆ—è¡¨ï¼ˆæ¯å‘¨ï¼‰
# æ·»åŠ åˆ° crontab
0 2 * * 0 cd /path/to/tts-api && ./venv/bin/python3 scripts/update_voices.py
```

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„è¯­éŸ³åŠŸèƒ½

1. **åœ¨ `voice_manager.py` ä¸­æ·»åŠ æ–°æ–¹æ³•**:

```python
def get_voices_by_quality(self, quality: str) -> List[Dict[str, Any]]:
    """æ ¹æ®éŸ³è´¨è·å–è¯­éŸ³åˆ—è¡¨"""
    # å®ç°é€»è¾‘
    pass
```

2. **åœ¨ `app_enhanced.py` ä¸­æ·»åŠ å¯¹åº”çš„ API ç«¯ç‚¹**:

```python
@app.route('/api/voices/quality/<quality>', methods=['GET'])
def get_voices_by_quality(quality):
    # API å®ç°
    pass
```

3. **æ·»åŠ æµ‹è¯•ç”¨ä¾‹**:

```python
def test_get_voices_by_quality(self):
    # æµ‹è¯•å®ç°
    pass
```

### è‡ªå®šä¹‰è¯­éŸ³ç­›é€‰

```python
from voice_manager import VoiceManager

def get_recommended_voices():
    """è·å–æ¨èçš„è¯­éŸ³åˆ—è¡¨"""
    vm = VoiceManager()
    voices = vm.get_chinese_voices()
    
    # è‡ªå®šä¹‰ç­›é€‰é€»è¾‘
    recommended = []
    for voice in voices:
        if voice['Locale'] == 'zh-CN' and voice['Status'] == 'GA':
            recommended.append(voice)
    
    return recommended
```

## æ›´æ–°æ—¥å¿—

### v2.1.0
- æ–°å¢è¯­éŸ³ç®¡ç†ç³»ç»Ÿ
- æ”¯æŒ 322+ ä¸ªè¯­éŸ³
- æ·»åŠ è¯­éŸ³æœç´¢å’ŒéªŒè¯åŠŸèƒ½
- é›†æˆè¯­éŸ³ç»Ÿè®¡å’Œåœ°åŒºç®¡ç†

### v2.0.0
- åˆå§‹è¯­éŸ³ç®¡ç†åŠŸèƒ½
- æ”¯æŒåŸºç¡€è¯­éŸ³åˆ—è¡¨è·å–
- é›†æˆé»˜è®¤è¯­éŸ³é…ç½®

---

å¦‚éœ€æ›´å¤šå¸®åŠ©ï¼Œè¯·æŸ¥çœ‹ [API å‚è€ƒæ–‡æ¡£](api-reference.md) æˆ– [æäº¤ Issue](https://github.com/qi-mooo/tts-api/issues)ã€‚